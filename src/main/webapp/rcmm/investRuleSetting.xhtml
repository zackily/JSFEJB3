<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui" template="/template.xhtml">


	<ui:define name="title">
		<h:outputText value="投資限制條文設定作業(RCMM03)" />
	</ui:define>

	<ui:define name="body">
		<h:form id="mainForm" style="width: 80%">
			<p:growl id="growl" life="2000" />
			<p:panel header="投資限制條文設定作業(RCMM03)">
				<p:panelGrid columns="2" style="width: 100%"
					columnClasses="ui-grid-col-2, ui-grid-col-11" layout="grid">
					<p:panelGrid columns="1" style="width: 100%" layout="grid">
						<p:commandButton value="新增"
							actionListener="#{investRuleSetController.create}"
							style="width: 100%" oncomplete="PF('createDialog').show();"
							update=":createDialog :dialogForm" process="@this" />
						<p:commandButton value="修改"
							actionListener="#{investRuleSetController.edit}"
							style="width: 100%" oncomplete="PF('createDialog').show();"
							update=":createDialog :dialogForm" process="@this" />
						<p:commandButton value="刪除"
							actionListener="#{investRuleSetController.delete}"
							style="width: 100%" onclick="PF('deleteConfirm').show()" />
						<p:commandButton value="鎖定" style="width: 100%" />
						<p:commandButton value="解鎖" style="width: 100%" />
					</p:panelGrid>
					<p:panelGrid columns="1" style="width: 100%">
						<p:panelGrid columns="4" style="width: 100%" layout="grid">
							<p:commandButton value="&lt;&lt;"
								actionListener="#{investRuleSetController.lookupMaster(0)}"
								style="width: 100%" update=":mainForm" />
							<p:commandButton value="&lt;"
								actionListener="#{investRuleSetController.lookupMaster(-1)}"
								style="width: 100%" update=":mainForm" />
							<p:commandButton value="&gt;"
								actionListener="#{investRuleSetController.lookupMaster(1)}"
								style="width: 100%" update=":mainForm" />
							<p:commandButton value="&gt;&gt;"
								actionListener="#{investRuleSetController.lookupMaster(investRuleSetController.master.size())}"
								style="width: 100%" update=":mainForm" />
						</p:panelGrid>
						<p:panelGrid columns="1" layout="grid"
							style="width:100%;margin: 0 auto">
							<p:panelGrid columns="2" layout="grid" style="width:100%"
								columnClasses="ui-grid-col-3, ui-grid-col-6">
								<p:panelGrid columns="2" layout="grid">
									<h:outputLabel value="投資限制代碼" />
									<p:autoComplete
										value="#{investRuleSetController.currentItem.ruleNo}"
										completeMethod="#{investRuleSetController.searchRuleListMaster}">
										<p:ajax event="itemSelect"
											listener="#{investRuleSetController.onItemSelect}"
											update=":mainForm" />
									</p:autoComplete>
								</p:panelGrid>
								<p:panelGrid columns="2" layout="grid"
									columnClasses="ui-grid-col-3, ui-grid-col-6">
									<h:outputLabel value="代碼類別" />
									<h:outputText converter="#{ruleClassConverter}"
										value="#{investRuleSetController.currentItem.ruleClass}" />
								</p:panelGrid>
							</p:panelGrid>
							<p:panelGrid columns="2" layout="grid">
								<h:outputLabel value="投資限制中文說明" />
								<h:outputText
									value="#{investRuleSetController.currentItem.ruleChnName}" />
							</p:panelGrid>
							<p:panelGrid columns="2" layout="grid">
								<h:outputLabel value="投資限制英文說明" />
								<h:outputText
									value="#{investRuleSetController.currentItem.ruleEngName}" />
							</p:panelGrid>
							<p:panelGrid columns="2" layout="grid">
								<h:outputLabel value="違規警示訊息" />
								<h:outputText
									value="#{investRuleSetController.currentItem.rtnMessage}" />
							</p:panelGrid>
							<p:panelGrid columns="3" layout="grid"
								columnClasses="ui-grid-col-5, ui-grid-col-5, ui-grid-col-5">
								<p:panelGrid columns="2" style="width:100%">
									<h:outputLabel value="檢核商品" />
									<h:outputText
										value="#{investRuleSetController.strTempRuleProduct}" />
								</p:panelGrid>
								<p:panelGrid columns="2" style="width:100%">
									<h:outputLabel value="交易類別" />
									<h:outputText
										value="#{investRuleSetController.strTempRuleTradeType}" />
								</p:panelGrid>
								<p:panelGrid columns="2" style="width:100%">
									<h:outputLabel value="檢核通路" />
									<h:outputText
										value="#{investRuleSetController.strTempRuleChannel}" />
								</p:panelGrid>
							</p:panelGrid>
							<p:panelGrid columns="2" layout="grid"
								columnClasses="ui-grid-col-3, ui-grid-col-4">
								<h:outputLabel value="檢核時點" />
								<h:outputText converter="#{checkTimingConverter}"
									value="#{investRuleSetController.currentItem.checkTiming}" />
							</p:panelGrid>
						</p:panelGrid>

					</p:panelGrid>
				</p:panelGrid>
				<p:panelGrid columns="2" style="width: 100%">
					<p:fieldset>
						<p:panelGrid columns="3" style="width: 100%">
							<h:outputLabel value="檢核結果計算邏輯" />
							<h:outputLabel value="客戶統計條件(單選)" />
							<h:outputText converter="#{clientAggregateConverter}"
								value="#{investRuleSetController.currentItem.clientAggregate}" />
						</p:panelGrid>
						<p:panelGrid columns="1" style="width: 100%">
							<f:facet name="header">
								<h:outputLabel value="分子條件設定區" />
							</f:facet>
							<p:panelGrid columns="2" style="width: 100%">
								<h:outputLabel value="分子標的合計方式" />
								<h:outputText converter="#{checkColumnConverter}"
									value="#{investRuleSetController.currentItem.checkColumn}" />
							</p:panelGrid>
							<p:dataTable var="dividend"
								value="#{investRuleSetController.ruleDividendList}"
								scrollable="true" scrollHeight="100">
								<p:column headerText="運算子">
									<h:outputLabel value="#{dividend.opCode}" />
								</p:column>
								<p:column headerText="資料範圍">
									<h:outputLabel value="#{dividend.scopeCode}" />
								</p:column>
								<p:column headerText="範圍名稱">
									<h:outputLabel value="#{dividend.scopeCode}" />
								</p:column>
							</p:dataTable>
							<p:panelGrid columns="4" style="width: 100%">
								<h:outputLabel value="法規生效期間" />
								<h:outputText
									value="#{investRuleSetController.currentItem.startDate}" />
								<h:outputLabel value="To" />
								<h:outputText
									value="#{investRuleSetController.currentItem.endDate}" />
							</p:panelGrid>

						</p:panelGrid>
					</p:fieldset>
					<p:fieldset>
						<p:panelGrid columns="2" style="width: 100%">
							<h:outputLabel value="檢核資料欄位" />
							<h:outputText converter="#{dividendAggregateConverter}"
								value="#{investRuleSetController.currentItem.dividendAggregate}" />
						</p:panelGrid>
						<p:panelGrid columns="1" style="width: 100%">
							<f:facet name="header">
								<h:outputLabel value="分母條件設定區" />
							</f:facet>
							<p:panelGrid columns="4" style="width: 100%">
								<h:outputLabel value="分母數值抓取方式" />
								<h:outputText converter="#{divisorSourceConverter}"
									value="#{investRuleSetController.currentItem.divisorSource}" />
								<h:outputLabel value="分母固定值" />
								<h:outputText
									value="#{investRuleSetController.currentItem.divisorValue}" />
							</p:panelGrid>
							<p:dataTable var="divisor"
								value="#{investRuleSetController.ruleDivisorList}"
								scrollable="true" scrollHeight="100">
								<p:column headerText="運算子">
									<h:outputLabel value="#{divisor.opCode}" />
								</p:column>
								<p:column headerText="資料範圍">
									<h:outputLabel value="#{divisor.scopeCode}" />
								</p:column>
								<p:column headerText="範圍名稱">
									<h:outputLabel value="#{divisor.scopeCode}" />
								</p:column>
							</p:dataTable>
							<p:panelGrid columns="4" style="width: 100%">
								<h:outputLabel value="超限條件" />
								<h:outputText converter="#{limitConditionConverter}"
									value="#{investRuleSetController.currentItem.limitCondition}" />
								<h:outputLabel value="超限值%" />
								<h:outputText
									value="#{investRuleSetController.currentItem.limitRate}" />
							</p:panelGrid>
						</p:panelGrid>
					</p:fieldset>


					<p:panelGrid columns="4" style="width: 100%">
						<h:outputLabel value="超限處理" />
						<h:outputText converter="#{limitReactionConverter}"
							value="#{investRuleSetController.currentItem.limitReaction}" />
						<h:outputLabel value="鎖定註記" />
						<p:selectBooleanCheckbox disabled="true"
							value="#{investRuleSetController.currentItem.lock}" />
					</p:panelGrid>

				</p:panelGrid>
			</p:panel>
			<p:confirmDialog header="刪除資料範圍" widgetVar="deleteConfirm"
				appendTo="@(body)">
				<f:facet name="message">
					<h:outputText value="是否確定要刪除?" />
				</f:facet>
				<p:commandButton title="GDelYesButton" value="Yes"
					actionListener="#{investRuleSetController.delete}"
					oncomplete="PF('deleteConfirm').hide()" process="@this"
					update=":mainForm :mainForm:growl" />
				<p:commandButton title="GDelNoButton" value="No"
					oncomplete="PF('deleteConfirm').hide()" />
			</p:confirmDialog>
		</h:form>
		<p:dialog id="createDialog"
			header="#{investRuleSetController.editDialogLabel}"
			widgetVar="createDialog" modal="true" height="950" width="1100"
			appendTo="@(body)">
			<h:form id="dialogForm">
				<p:panelGrid columns="1" style="width: 100%">
					<p:panelGrid columns="1" layout="grid"
						style="width:100%;margin: 0 auto">
						<p:panelGrid columns="2" layout="grid" style="width:100%"
							columnClasses="ui-grid-col-3, ui-grid-col-6">
							<p:panelGrid columns="2" layout="grid">
								<h:outputLabel value="投資限制代碼" />
								<h:outputText value="#{investRuleSetController.item.ruleNo}" />
							</p:panelGrid>
							<p:panelGrid columns="2" layout="grid"
								columnClasses="ui-grid-col-2, ui-grid-col-8">
								<h:outputLabel value="代碼類別" />
								<p:selectOneRadio columns="3" layout="grid"
									value="#{investRuleSetController.item.ruleClass}" label="代碼類別"
									style="width:100%" required="true">
									<f:selectItems value="#{investRuleSetController.ruleClassList}" />
								</p:selectOneRadio>
							</p:panelGrid>
						</p:panelGrid>
						<p:panelGrid columns="2" layout="grid">
							<h:outputLabel value="投資限制中文說明" />
							<h:inputText value="#{investRuleSetController.item.ruleChnName}" />
						</p:panelGrid>
						<p:panelGrid columns="2" layout="grid">
							<h:outputLabel value="投資限制英文說明" />
							<h:inputText value="#{investRuleSetController.item.ruleEngName}" />
						</p:panelGrid>
						<p:panelGrid columns="2" layout="grid">
							<h:outputLabel value="違規警示訊息" />
							<h:inputText value="#{investRuleSetController.item.rtnMessage}" />
						</p:panelGrid>
						<p:panelGrid columns="3" layout="grid"
							columnClasses="ui-grid-col-5, ui-grid-col-5, ui-grid-col-5">
							<p:panelGrid columns="2" style="width:100%">
								<h:outputLabel value="檢核商品" />
								<p:selectManyCheckbox layout="grid" columns="2"
									value="#{investRuleSetController.tempRuleProduct}">
									<f:selectItems
										value="#{investRuleSetController.ruleProductList}" />
								</p:selectManyCheckbox>
							</p:panelGrid>
							<p:panelGrid columns="2" style="width:100%">
								<h:outputLabel value="交易類別" />
								<p:selectManyCheckbox layout="grid" columns="2"
									value="#{investRuleSetController.tempRuleTradeType}">
									<f:selectItems
										value="#{investRuleSetController.ruleTradeTypeList}" />
								</p:selectManyCheckbox>
							</p:panelGrid>
							<p:panelGrid columns="2" style="width:100%">
								<h:outputLabel value="檢核通路" />
								<p:selectManyCheckbox layout="grid" columns="2"
									value="#{investRuleSetController.tempRuleChannel}">
									<f:selectItems
										value="#{investRuleSetController.ruleChannelList}" />
								</p:selectManyCheckbox>
							</p:panelGrid>
						</p:panelGrid>
						<p:panelGrid columns="2" layout="grid"
							columnClasses="ui-grid-col-1, ui-grid-col-9">
							<h:outputLabel value="檢核時點" />
							<p:selectOneMenu label="檢核時點" required="true"
								value="#{investRuleSetController.item.checkTiming}">
								<f:selectItems
									value="#{investRuleSetController.checkTimingList}" />
							</p:selectOneMenu>
						</p:panelGrid>
					</p:panelGrid>

				</p:panelGrid>
				<p:panelGrid columns="2" style="width: 100%">
					<p:fieldset>
						<p:panelGrid columns="5" style="width: 100%">
							<h:outputLabel value="檢核結果計算邏輯" />
							<p:commandButton value="＋"
								actionListener="#{investRuleSetController.addDividendList}"
								update=":dialogForm:dividendTable" process="@this" />
							<h:outputLabel value="客戶統計條件(單選)" />
							<p:selectOneMenu
								value="#{investRuleSetController.item.clientAggregate}">
								<f:selectItems
									value="#{investRuleSetController.clientAggregateList}" />
							</p:selectOneMenu>
						</p:panelGrid>
						<p:panelGrid columns="1" style="width: 100%">

							<f:facet name="header">
								<h:outputLabel value="分子條件設定區" />
							</f:facet>
							<p:panelGrid columns="2" style="width: 100%">
								<h:outputLabel value="分子標的合計方式" />
								<p:selectOneMenu
									value="#{investRuleSetController.item.checkColumn}">
									<f:selectItems
										value="#{investRuleSetController.checkColumnList}" />
								</p:selectOneMenu>
							</p:panelGrid>
							<p:dataTable var="dividend" id="dividendTable"
								value="#{investRuleSetController.ruleDividendList}"
								scrollable="true" scrollHeight="100">
								<p:column>
									<p:commandButton value="－"
										actionListener="#{investRuleSetController.removeDividendList(dividend)}"
										update=":dialogForm:dividendTable" process="@this" />
								</p:column>
								<p:column headerText="運算子">
									<p:selectOneMenu value="#{dividend.opCode}">
										<f:selectItem itemLabel="+" itemValue="+" />
										<f:selectItem itemLabel="-" itemValue="-" />
									</p:selectOneMenu>
								</p:column>
								<p:column headerText="資料範圍">
									<p:selectOneMenu value="#{dividend.scopeCode}">
										<f:selectItems value="#{investRuleSetController.scopeCodeMenu" />
									</p:selectOneMenu>
								</p:column>
								<p:column headerText="範圍名稱">
									<h:outputText converter="#{}" value="#{dividend.scopeCode}" />
								</p:column>
							</p:dataTable>
							<p:panelGrid columns="4" style="width: 100%">
								<h:outputLabel value="法規生效期間" />
								<p:calendar pattern="yyyyMMdd"
									value="#{investRuleSetController.item.startDate}">
									<f:convertDateTime type="date" dateStyle="short"
										pattern="yyyyMMdd" />
								</p:calendar>
								<h:outputLabel value="To" />
								<p:calendar pattern="yyyyMMdd"
									value="#{investRuleSetController.item.endDate}">
									<f:convertDateTime type="date" dateStyle="short"
										pattern="yyyyMMdd" />
								</p:calendar>
							</p:panelGrid>

						</p:panelGrid>
					</p:fieldset>
					<p:fieldset>
						<p:panelGrid columns="4" style="width: 100%">
							<h:outputLabel value="檢核資料欄位" />
							<p:commandButton value="＋"
								actionListener="#{investRuleSetController.addDivisorList}"
								update=":dialogForm:divisorTable" process="@this" />
							<p:selectOneMenu
								value="#{investRuleSetController.item.dividendAggregate}">
								<f:selectItems
									value="#{investRuleSetController.dividendAggregateList}" />
							</p:selectOneMenu>
						</p:panelGrid>
						<p:panelGrid columns="1" style="width: 100%">
							<f:facet name="header">
								<h:outputLabel value="分母條件設定區" />
							</f:facet>
							<p:panelGrid columns="4" style="width: 100%">
								<h:outputLabel value="分母數值抓取方式" />
								<p:selectOneMenu
									value="#{investRuleSetController.item.divisorSource}">
									<f:selectItems
										value="#{investRuleSetController.dividsorSourceList}" />
								</p:selectOneMenu>
								<h:outputLabel value="分母固定值" />
								<h:inputText
									value="#{investRuleSetController.item.divisorValue}" />
							</p:panelGrid>
							<p:dataTable var="divisor" id="divisorTable"
								value="#{investRuleSetController.ruleDivisorList}"
								scrollable="true" scrollHeight="100">
								<p:column>
									<p:commandButton value="－"
										actionListener="#{investRuleSetController.removeDivisorList(divisor)}"
										update=":dialogForm:divisorTable" process="@this" />
								</p:column>
								<p:column headerText="運算子">
									<p:selectOneMenu value="#{divisor.opCode}">
										<f:selectItem itemLabel="+" itemValue="+" />
										<f:selectItem itemLabel="-" itemValue="-" />
									</p:selectOneMenu>
								</p:column>
								<p:column headerText="資料範圍">
									<p:selectOneMenu value="#{dividend.scopeCode}">
										<f:selectItems value="#{investRuleSetController.scopeCodeMenu" />
									</p:selectOneMenu>
								</p:column>
								<p:column headerText="範圍名稱">
									<h:outputText converter="#{}" value="#{dividend.scopeCode}" />
								</p:column>
							</p:dataTable>
							<p:panelGrid columns="4" style="width: 100%">
								<h:outputLabel value="超限條件" />
								<p:selectOneMenu label="超限條件" required="true"
									value="#{investRuleSetController.item.limitCondition}">
									<f:selectItems
										value="#{investRuleSetController.limitConditionList}" />
								</p:selectOneMenu>
								<h:outputLabel value="超限值%" />
								<h:inputText label="超限值%" required="true"
									value="#{investRuleSetController.item.limitRate}" />
							</p:panelGrid>

						</p:panelGrid>

					</p:fieldset>


					<p:panelGrid columns="4" style="width: 100%">
						<h:outputLabel value="超限處理" />
						<p:selectOneMenu
							value="#{investRuleSetController.item.limitReaction}">
							<f:selectItems
								value="#{investRuleSetController.limitReactionList}" />
						</p:selectOneMenu>
						<h:outputLabel value="鎖定註記" />
						<p:selectBooleanCheckbox label="鎖定註記" required="true"
							value="#{investRuleSetController.item.lock}" />
					</p:panelGrid>
				</p:panelGrid>
				<p:panel>
					<p:commandButton value="儲存"
						actionListener="#{investRuleSetController.save}"
						update=":growl :mainForm :dialogForm"
						oncomplete="PF('createDialog').hide()" />
					<p:commandButton value="取消" oncomplete="PF('createDialog').hide()"
						actionListener="#{investRuleSetController.clearList}"
						update=":growl :mainForm :dialogForm" process="@this" />
				</p:panel>
			</h:form>
		</p:dialog>
	</ui:define>
</ui:composition>