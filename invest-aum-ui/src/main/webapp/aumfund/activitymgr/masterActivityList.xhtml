<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                template="/templates/generalPageTemplateHome.xhtml">


    <ui:define name="title">
        <h:outputText value="主活動設定畫面"></h:outputText>
    </ui:define>

    <ui:define name="body">

        <h:form id="MgSetMasterListForm">
            <p:growl id="msgs" autoUpdate="true"/>
            <p:fieldset>
                <p:commandButton id="createButton" icon="ui-icon-plus"   value="新增主活動"
                                 actionListener="#{mgSetMasterController.prepareCreate}" 
                                 update=":MgSetMasterCreateForm" oncomplete="PF('MgSetMasterCreateDialog').show()"
                                 rendered="#{userSession.user.role eq '1'}"/>
                <p:separator />

                <p:panelGrid style="width:100%" >
                    <p:row>
                        <p:column styleClass="ui-widget-header">   
                            <p:outputLabel value="主活動代碼"/>
                        </p:column>
                        <p:column> 
                            <p:inputText value="#{mgSetMasterController.masterVO.mgActMCode}"/>
                        </p:column>
                        <p:column styleClass="ui-widget-header">   
                            <p:outputLabel value="主活動名稱"/>
                        </p:column>
                        <p:column>   
                            <p:inputText value="#{mgSetMasterController.masterVO.mgActMName}"/>
                        </p:column>

                    </p:row>

                    <p:row>
                        <p:column colspan="6">
                            <center>
                                <p:commandButton icon="ui-icon-search" value="查詢" actionListener="#{mgSetMasterController.search()}" 
                                                 update=":MgSetMasterCreateForm :MgSetMasterListForm:datalist :MgSetDetailCreateForm" />                                                                                           
                            </center>
                        </p:column>

                    </p:row>

                </p:panelGrid>
            </p:fieldset>

            <p:spacer height="10"/>
            <!--<p:fieldset>-->
            <p:dataTable id="datalist" value="#{mgSetMasterController.items}" var="item"                       
                         paginator="true"
                         rowKey="#{item.id}"
                         rows="10"                         
                         rowsPerPageTemplate="10,20,30,40,50"
                         emptyMessage="查無資料"                        
                         >
                <p:column>
                    <f:facet name="header">
                        <h:outputText value="主活動代碼"/>
                    </f:facet>
                    <h:outputText value="#{item.mgActMCode}"/>
                </p:column>
                <p:column>
                    <f:facet name="header">
                        <h:outputText value="主活動名稱"/>
                    </f:facet>
                    <h:outputText value="#{item.mgActMName}"/>

                </p:column>
                <p:column>
                    <f:facet name="header">
                        <h:outputText value="活動計算基礎"/>
                    </f:facet>

                    <h:outputText value="#{mgSetMasterController.toMgMType(item.mgActMType)}"/>


                </p:column>
                <p:column>
                    <f:facet name="header">
                        <h:outputText value="活動計算規則"/>
                    </f:facet>
                    <h:outputText value="#{mgSetMasterController.toMgActMRateSet(item.mgActMRateSet)}"/>

                </p:column>

                <p:column>
                    <f:facet name="header">
                        <h:outputText value="建立經辦"/>
                    </f:facet>
                    <h:outputText value="#{item.crtEmpId}"/><br/>
                    <h:outputText value="#{item.crtEmpName}"/>
                </p:column>

                <p:column>
                    <f:facet name="header">
                        <h:outputText value="建立時間"/>
                    </f:facet>
                    <h:outputText value="#{mgSetMasterController.toStringDate(item.crtDate,'yyyyMMdd HH:mm')}"/>
                </p:column>

                <p:column>
                    <f:facet name="header">
                        <h:outputText value="覆核主管"/>
                    </f:facet>
                    <h:outputText value="#{item.cfmEmpId}"/><br/>
                    <h:outputText value="#{item.cfmEmpName}"/>
                </p:column>

                <p:column>
                    <f:facet name="header">
                        <h:outputText value="覆核時間"/>
                    </f:facet>
                    <h:outputText value="#{mgSetMasterController.toStringDate(item.cfmDate,'yyyyMMdd HH:mm')}"/>
                </p:column>

                <p:column>
                    <f:facet name="header">
                        <h:outputText value="狀態"/>
                    </f:facet>
                    <h:outputText value="#{item.status.status}"/>
                </p:column>

                <p:column>
                    <f:facet name="header">
                        <h:outputText value="收費對象"/>
                    </f:facet>
                    <h:outputText value="#{mgSetMasterController.toMgActMChargeObj(item.mgActMChargeObj)}"/>
                </p:column>



                <p:column>
                    <f:facet name="header">
                        <h:outputText value="活動案備註"/>
                    </f:facet>
                    <h:outputText value="#{item.mgActMRemark}"/>


                </p:column>

                <!--                <p:column>
                                    <f:facet name="header">
                                        <h:outputText value="目前子活動"/>
                                    </f:facet>
                                    <h:outputText value="#{mgSetMasterController.toCollectionSize(item.mgSetDetailCollection)}"/>
                                </p:column>-->


                <p:column style="width:20%">
                    <f:facet name="header">
                        <h:outputText value=""/>
                    </f:facet>
<!--                    <p:commandButton icon="ui-icon-plus" value="建立子活動" actionListener="#{mgSetMasterController.addDetail(item)}" 
                                     update=":MgSetMasterCreateForm :MgSetDetailCreateForm" oncomplete="PF('MgSetDetailCreateDialog').show()" 
                                     rendered="#{userSession.user.role.equalsIgnoreCase('1')}"/>                     -->
                     <p:commandButton icon="ui-icon-pencil" value="內容" actionListener="#{mgSetMasterController.prepareUpdate(item)}" 
                                     update=":MgSetMasterCreateForm" oncomplete="PF('MgSetMasterCreateDialog').show()" 
                                     /> 
<!--                    <p:commandButton icon="ui-icon-pencil" value="修改" actionListener="#{mgSetMasterController.prepareUpdate(item)}" 
                                     update=":MgSetMasterCreateForm" oncomplete="PF('MgSetMasterCreateDialog').show()"
                                     rendered="#{userSession.user.role.equalsIgnoreCase('1')}"/> -->
<!--                    <p:commandButton icon="ui-icon-minus" value="刪除" actionListener="#{mgSetMasterController.prepareUpdate(item)}" 
                                     update=":MgSetMasterCreateForm" oncomplete="PF('MgSetMasterCreateDialog').show()"
                                     rendered="#{userSession.user.role.equalsIgnoreCase('1')}"/> -->
<!--                    <p:commandButton icon="ui-icon-confirm" value="覆核同意" actionListener="#{mgSetMasterController.prepareUpdate(item)}" 
                                     update=":MgSetMasterCreateForm" oncomplete="PF('MgSetMasterCreateDialog').show()"
                                     rendered="#{mgSetMasterController.showConfirm(item)}"/> -->
<!--                    <p:commandButton icon="ui-icon-reject" value="退回" actionListener="#{mgSetMasterController.prepareUpdate(item)}" 
                                     update=":MgSetMasterCreateForm" oncomplete="PF('MgSetMasterCreateDialog').show()"
                                     rendered="#{mgSetMasterController.showRejectBtn(item)}"/> -->
                    <!--<p:commandButton icon="ui-icon-document" value="匯入子活動" actionListener="#{mgSetMasterController.importDetail(item)}" update=":MgSetMasterCreateForm :MgSetDetailImportForm :MgSetDetailCreateForm" oncomplete="PF('MgSetDetailImportDlg').show()"/>--> 
<!--                    <p:commandButton icon="ui-icon-search" value="子活動清單" actionListener="#{mgSetMasterController.findByMasterId(item)}" 
                                     update=":MgSetMasterCreateForm :MgSetDetailListForm:detailDatalist" oncomplete="PF('MgSetDetailListDlg').show()" />-->
                </p:column>


                <!--                <f:facet name="footer">
                                    <p:commandButton id="createButton" icon="ui-icon-plus"   value="#{bundle.Create}" actionListener="#{mgSetMasterController.prepareCreate}" update=":MgSetMasterCreateForm" oncomplete="PF('MgSetMasterCreateDialog').show()"/>
                                    <p:commandButton id="viewButton"   icon="ui-icon-search" value="#{bundle.View}" update=":MgSetMasterViewForm" oncomplete="PF('MgSetMasterViewDialog').show()" disabled="#{empty mgSetMasterController.selected}"/>
                                    <p:commandButton id="editButton"   icon="ui-icon-pencil" value="#{bundle.Edit}" update=":MgSetMasterEditForm" oncomplete="PF('MgSetMasterEditDialog').show()" disabled="#{empty mgSetMasterController.selected}"/>
                                    <p:commandButton id="deleteButton" icon="ui-icon-trash"  value="#{bundle.Delete}" actionListener="#{mgSetMasterController.destroy}" update=":growl,datalist" disabled="#{empty mgSetMasterController.selected}"/>
                                </f:facet>-->
            </p:dataTable>
            <!--</p:fieldset>-->
        </h:form>

        <ui:include src="activityDialog.xhtml"/>
        <ui:include src="/jsff/ajaxStatusDlg.xhtml"/>  
    </ui:define>
</ui:composition>