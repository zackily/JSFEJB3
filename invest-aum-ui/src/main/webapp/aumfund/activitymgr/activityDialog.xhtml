<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

    <ui:composition>

        <p:dialog id="MgSetMasterCreateDlg" widgetVar="MgSetMasterCreateDialog" modal="true" resizable="false"  header="管理費主活動案新增設定" width="60%">
            <h:form id="MgSetMasterCreateForm">

                <p:panelGrid rendered="#{mgSetMasterController.selected != null}" style="width: 100%">
                    
                    <p:row>
                        <p:column styleClass="ui-widget-header">
                            <p:outputLabel value="活動案收費對象" for="mgActMChargeObj" />
                        </p:column>
                        <p:column>
                            <p:selectOneRadio id="mgActMChargeObj" value="#{mgSetMasterController.selected.mgActMChargeObj}" 
                                              required="true" requiredMessage="請選擇活動案收費對象" disabled="#{userSession.user.role.equalsIgnoreCase('4')}">                                           
                                <f:selectItem itemLabel="向客戶收費" itemValue="C" /> 
                                <f:selectItem itemLabel="支付合作對象" itemValue="P" />      
                                <p:ajax event="change" update=":MgSetMasterCreateForm:mgActMCode"/>
                            </p:selectOneRadio> 
                        </p:column>
                    </p:row>
                    
                    <p:row>
                        <p:column styleClass="ui-widget-header">
                            <p:outputLabel value="活動類型代碼" for="mgActMCode" />
                        </p:column>
                        <p:column>
                            <p:outputLabel id="mgActMCode" value="#{mgSetMasterController.selected.mgActMChargeObj}#{mgSetMasterController.showMgSetMasterCode()}"  />
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column styleClass="ui-widget-header">
                            <p:outputLabel value="活動名稱" for="mgActMName" />
                        </p:column>
                        <p:column>
                            <p:inputText size="50" id="mgActMName" value="#{mgSetMasterController.selected.mgActMName}" 
                                         title="#{bundle.CreateMgSetMasterTitle_mgActMName}" required="true" requiredMessage="請輸入活動名稱" 
                                         disabled="#{userSession.user.role.equalsIgnoreCase('4')}"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column styleClass="ui-widget-header">
                            <p:outputLabel value="活動計算基礎" for="mgActMType" />
                        </p:column>
                        <p:column>
                            <p:selectOneRadio id="mgActMType" value="#{mgSetMasterController.selected.mgActMType}"
                                              required="true" requiredMessage="請選擇活動計算基礎" disabled="#{userSession.user.role.equalsIgnoreCase('4')}">                                  
                                <f:selectItem itemLabel="AUM(參考現值)" itemValue="1" /> 
                                <f:selectItem itemLabel="成本(信託本金)" itemValue="2" /> 
                            </p:selectOneRadio> 
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column styleClass="ui-widget-header">
                            <p:outputLabel value="活動計算規則" for="mgActMRateSet" />
                        </p:column>
                        <p:column>
                            <p:selectOneRadio id="mgActMRateSet" value="#{mgSetMasterController.selected.mgActMRateSet}" 
                                              required="true" requiredMessage="請選擇活動計算規則" disabled="#{userSession.user.role.equalsIgnoreCase('4')}">                                            
                                <f:selectItem itemLabel="LOW(取最小值)" itemValue="1" /> 
                                <f:selectItem itemLabel="HIGH(取最大值)" itemValue="2" /> 
                                <f:selectItem itemLabel="依子活動代碼" itemValue="3" /> 
                            </p:selectOneRadio> 
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column styleClass="ui-widget-header">
                            <p:outputLabel value="備註" for="mgActMRemark" />
                        </p:column>
                        <p:column>
                            <p:inputTextarea rows="10" cols="60" id="mgActMRemark" value="#{mgSetMasterController.selected.mgActMRemark}" 
                                             title="#{bundle.CreateMgSetMasterTitle_mgActMRemark}" disabled="#{userSession.user.role.equalsIgnoreCase('2')}" />
                        </p:column>
                    </p:row>
                </p:panelGrid>
                <center>
                    <p:commandButton icon="ui-icon-cancel" actionListener="#{mgSetMasterController.reset}" value="取消" onclick="PF('MgSetMasterCreateDialog').hide();" process="@this" />
                    <p:commandButton icon="ui-icon-plus" actionListener="#{mgSetMasterController.create}" value="送出覆核" 
                                     update=":MgSetMasterListForm:datalist,:growl" oncomplete="handleSubmit(args,'MgSetMasterCreateDialog');"
                                     rendered="#{userSession.user.role.equalsIgnoreCase('3')}"/>
                    <p:commandButton icon="ui-icon-confirm" actionListener="#{mgSetMasterController.confirm('CONFIRM')}" value="同意覆核" 
                                     update=":MgSetMasterListForm:datalist,:growl" oncomplete="handleSubmit(args,'MgSetMasterCreateDialog');"
                                     rendered="#{userSession.user.role.equalsIgnoreCase('4')}"/>
                    <p:commandButton icon="ui-icon-reject" actionListener="#{mgSetMasterController.confirm('REJECT')}" value="退回" 
                                     update=":MgSetMasterListForm:datalist,:growl" oncomplete="handleSubmit(args,'MgSetMasterCreateDialog');"
                                     rendered="#{userSession.user.role.equalsIgnoreCase('4')}"/>
                    <p:commandButton icon="ui-icon-minus" actionListener="#{mgSetMasterController.update('DELETE')}" value="刪除" 
                                     update=":MgSetMasterListForm:datalist,:growl" oncomplete="handleSubmit(args,'MgSetMasterCreateDialog');"
                                     rendered="#{userSession.user.role.equalsIgnoreCase('3')}"/>

                </center>

            </h:form>
        </p:dialog>

        <p:dialog id="MgSetDetailCreateDlg" widgetVar="MgSetDetailCreateDialog" modal="true" resizable="false" appendTo="@(body)" header="管理費子活動案設定" width="900px">
            <h:form id="MgSetDetailCreateForm" prependId="false">
                <p:wizard flowListener="#{mgSetMasterController.onFlowProcess}">

                    <p:tab id="summary" title="子活動案設定">
                        <hr/>
                        <p:panelGrid rendered="#{mgSetMasterController.mgSetDetail != null}" style="width: 100%">                     
                            <p:row>
                                <p:column styleClass="ui-widget-header">
                                    <p:outputLabel value="子活動案代碼" for="mgActDCode" />
                                </p:column>
                                <p:column>
                                    <p:outputLabel id="mgActDCode" value="#{mgSetMasterController.selected.mgActMCode}-#{mgSetMasterController.showMgSetDetailCode()}" 
                                                   title="#{bundle.CreateMgSetDetailTitle_mgActDCode}" />                          
                                </p:column>
                                <p:column styleClass="ui-widget-header">
                                    <p:outputLabel value="子活動案序號" for="mgActDSeq" />
                                </p:column>
                                <p:column>
                                    <p:outputLabel id="mgActDSeq" value="#{mgSetMasterController.showMgSetDetailCode()}" title="#{bundle.CreateMgSetDetailTitle_mgActDSeq}" />            
                                </p:column>
                            </p:row>

                            <p:row>
                                <p:column styleClass="ui-widget-header">
                                    <p:outputLabel value="子活動案名稱" for="mgActDName" />
                                </p:column>
                                <p:column>
                                    <p:inputText size="30" id="mgActDName" value="#{mgSetMasterController.mgSetDetail.mgActDName}" title="#{bundle.CreateMgSetDetailTitle_mgActDName}" 
                                                 required="true" requiredMessage="請輸入子活動案名稱"/>       
                                </p:column>
                                <p:column styleClass="ui-widget-header">
                                    <p:outputLabel value="子活動案種類" for="mgActSetType" />  
                                </p:column>
                                <p:column>
                                    <p:selectOneRadio id="mgActSetType" value="#{mgSetMasterController.mgSetDetail.mgActSetType}" required="true" requiredMessage="請選擇子活動案種類">                                           
                                        <f:selectItem itemLabel="固定費用" itemValue="F" /> 
                                        <f:selectItem itemLabel="費率" itemValue="R" /> 
                                    </p:selectOneRadio>
                                </p:column>
                            </p:row>

                            <p:row>
                                <p:column styleClass="ui-widget-header">
                                    <p:outputLabel value="產品代號" for="mgActDPrdCode" />  
                                </p:column>
                                <p:column>
                                    <p:inputText id="mgActDPrdCode" value="#{mgSetMasterController.mgSetDetail.mgActDPrdCode}" title="#{bundle.CreateMgSetDetailTitle_mgActDPrdCode}" 
                                                 required="true" requiredMessage="請輸入產品代號"/>
                                </p:column>
                                <p:column styleClass="ui-widget-header">
                                    <p:outputLabel value="SECURITY類型" for="mgActDSecType" />  
                                </p:column>
                                <p:column>
                                    <p:selectOneRadio id="mgActDSecType" value="#{mgSetMasterController.mgSetDetail.mgActDSecType}"
                                                      required="true" requiredMessage="請選擇SECURITY類型" >
                                        <f:selectItem itemLabel="Stock" itemValue="1" />
                                        <f:selectItem itemLabel="Bond" itemValue="2" />
                                        <f:selectItem itemLabel="Fund" itemValue="3" />
                                    </p:selectOneRadio>
                                </p:column>
                            </p:row>

                            <p:row>
                                <p:column styleClass="ui-widget-header">
                                    <p:outputLabel value="Security Company" for="mgActDSecCmp" />
                                </p:column>
                                <p:column>
                                    <p:inputText id="mgActDSecCmp" value="#{mgSetMasterController.mgSetDetail.mgActDSecCmp}" title="#{bundle.CreateMgSetDetailTitle_mgActDSecCmp}" 
                                                 required="true" requiredMessage="請輸入Security Company"/>
                                </p:column>
                                <p:column styleClass="ui-widget-header">
                                    <p:outputLabel value="Security Code" for="mgActDSecCode" />
                                </p:column>
                                <p:column>
                                    <p:inputText id="mgActDSecCode" value="#{mgSetMasterController.mgSetDetail.mgActDSecCode}" title="#{bundle.CreateMgSetDetailTitle_mgActDSecCode}" 
                                                 required="true" requiredMessage="請輸入Security Code"/>
                                </p:column>
                            </p:row>

                            <p:row>
                                <p:column styleClass="ui-widget-header">
                                    <p:outputLabel value="客戶代碼" for="mgActDCostId" />
                                </p:column>
                                <p:column>
                                    <p:inputText id="mgActDCostId" value="#{mgSetMasterController.mgSetDetail.mgActDCostId}" title="#{bundle.CreateMgSetDetailTitle_mgActDCostId}" 
                                                 required="true" requiredMessage="請輸入客戶代碼"/>
                                </p:column>
                                <p:column styleClass="ui-widget-header">
                                    <p:outputLabel value="業務通路代碼" for="mgActDSaleChnl" />
                                </p:column>
                                <p:column>                                    
                                    <p:selectOneRadio id="mgActDSaleChnl" value="#{mgSetMasterController.mgSetDetail.mgActDSaleChnl}" required="true" requiredMessage="請選擇業務通路代碼">
                                        <f:selectItem itemLabel="櫃檯" itemValue="1" />
                                        <f:selectItem itemLabel="網路" itemValue="2" />
                                        <f:selectItem itemLabel="語音" itemValue="3" />
                                        <f:selectItem itemLabel="KOKO" itemValue="4" />
                                    </p:selectOneRadio>
                                </p:column>
                            </p:row>

                            <p:row>
                                <p:column styleClass="ui-widget-header">
                                    <p:outputLabel value="子活動案開始日期" for="mgActDStartDate" />
                                </p:column>
                                <p:column>
                                    <p:calendar pattern="yyyyMMdd" id="mgActDStartDate" value="#{mgSetMasterController.start_date}" title="#{bundle.CreateMgSetDetailTitle_mgActDStartDate}"
                                                required="true" requiredMessage="請選擇子活動案開始日期">
                                        <f:convertDateTime type="date"  dateStyle="short" pattern="yyyyMMdd" />
                                    </p:calendar>
                                </p:column>
                                <p:column styleClass="ui-widget-header">
                                    <p:outputLabel value="子活動案結束日期" for="mgActDEndDate" />
                                </p:column>
                                <p:column>
                                    <p:calendar pattern="yyyyMMdd" id="mgActDEndDate" value="#{mgSetMasterController.end_date}" title="#{bundle.CreateMgSetDetailTitle_mgActDEndDate}"
                                                required="true" requiredMessage="請選擇子活動案結束日期">
                                        <f:convertDateTime type="date"  dateStyle="short" pattern="yyyyMMdd" />
                                    </p:calendar>
                                </p:column>
                            </p:row>

                            <p:row>
                                <p:column styleClass="ui-widget-header">
                                    <p:outputLabel value="級距設定序號???" for="mgActDSetNo" />
                                </p:column>
                                <p:column>
                                    <p:inputNumber id="mgActDSetNo" value="#{mgSetMasterController.mgSetDetail.mgActDSetNo}" title="#{bundle.CreateMgSetDetailTitle_mgActDSetNo}" />
                                </p:column>
                                <p:column styleClass="ui-widget-header">
                                    <p:outputLabel value="Base amount" for="mgActDBaseAmt" />
                                </p:column>
                                <p:column>
                                    <p:inputNumber id="mgActDBaseAmt" value="#{mgSetMasterController.mgSetDetail.mgActDBaseAmt}" title="#{bundle.CreateMgSetDetailTitle_mgActDBaseAmt}" />
                                </p:column>
                            </p:row>

                            <p:row>
                                <p:column styleClass="ui-widget-header">
                                    <p:outputLabel value="最低金額" for="mgActDLowAmt" />
                                </p:column>
                                <p:column>
                                    <p:inputNumber id="mgActDLowAmt" value="#{mgSetMasterController.mgSetDetail.mgActDLowAmt}" title="#{bundle.CreateMgSetDetailTitle_mgActDLowAmt}" />
                                </p:column>
                                <p:column styleClass="ui-widget-header">
                                    <p:outputLabel value="最高金額" for="mgActDHighAmt" />
                                </p:column>
                                <p:column>
                                    <p:inputNumber id="mgActDHighAmt" value="#{mgSetMasterController.mgSetDetail.mgActDHighAmt}" title="#{bundle.CreateMgSetDetailTitle_mgActDHighAmt}" />
                                </p:column>
                            </p:row>   

                            <p:row>
                                <p:column styleClass="ui-widget-header">
                                    <p:outputLabel value="一年管理費率" for="mgActDRate" />
                                </p:column>
                                <p:column>
                                    <p:inputNumber id="mgActDRate" value="#{mgSetMasterController.mgSetDetail.mgActDRate}" title="#{bundle.CreateMgSetDetailTitle_mgActDRate}" />
                                </p:column>
                                <p:column styleClass="ui-widget-header">
                                    <p:outputLabel value="管理費金額??" for="mgActDFee" />
                                </p:column>
                                <p:column>
                                    <p:inputNumber id="mgActDFee" value="#{mgSetMasterController.mgSetDetail.mgActDFee}" title="#{bundle.CreateMgSetDetailTitle_mgActDFee}" />
                                </p:column>
                            </p:row> 

                            <p:row>
                                <p:column styleClass="ui-widget-header">
                                    <p:outputLabel value="備註" for="mgActDRemark" />
                                </p:column>
                                <p:column colspan="3">
                                    <p:inputTextarea cols="100" rows="8" id="mgActDRemark" value="#{mgSetMasterController.mgSetDetail.mgActDRemark}" title="#{bundle.CreateMgSetDetailTitle_mgActDRemark}" />
                                </p:column>
                            </p:row> 

                        </p:panelGrid>
                        <!--<h:selectBooleanCheckbox value="#{mgSetMasterController.skip}" />-->

                    </p:tab>

                    <p:tab  title="基金對應設定">

                        <p:panelGrid style="width: 100%">
                            <p:row>
                                <p:column styleClass="ui-widget-header">
                                    <h:outputLabel for="company" value="基金公司" />　
                                </p:column>
                                <p:column>
                                    <p:selectCheckboxMenu id="company" value="#{mgSetMasterController.selectedInvCorp}" label="Company" multiple="true"
                                                          filter="true" filterMatchMode="endsWith" panelStyle="width:250px">
                                        <f:selectItems value="#{mgSetMasterController.invCorp}" var="invcorp" itemLabel="#{invcorp.corpCName}" itemValue="#{invcorp.corpID}" />
                                        <p:ajax listener="#{mgSetMasterController.updateFundList()}" event="change" update=":MgSetDetailCreateForm:code" />
                                    </p:selectCheckboxMenu>
                                </p:column>
                                <p:column styleClass="ui-widget-header">
                                    <h:outputLabel for="code" value="基金代碼" />
                                </p:column>
                                <p:column>
                                    <p:selectCheckboxMenu id="code" value="#{mgSetMasterController.selectedFundId}" label="Code" multiple="true"
                                                          filter="true" filterMatchMode="startsWith" panelStyle="width:250px">
                                        <f:selectItems value="#{mgSetMasterController.fundId}" var="fund" itemLabel="#{fund.fundCShortNM}" itemValue="#{fund.fundID}" />
                                    </p:selectCheckboxMenu>
                                </p:column>
                            </p:row>
                        </p:panelGrid>

                    </p:tab>

                    <p:tab id="import" title="匯入IDN" >
                        <p:panelGrid>
                            <p:row>
                                <p:fileUpload label="選擇檔案" auto="true" fileUploadListener="#{mgSetMasterController.handleFileUpload}" mode="advanced" dragDropSupport="false"
                                              update="idnlist" sizeLimit="100000" fileLimit="3" allowTypes="/(\.|\/)(csv)$/" />
                            </p:row>  
                        </p:panelGrid>
                        <p:dataTable id="idnlist" value="#{mgSetMasterController.idnList}" var="item"                             
                                     paginator="true"                            
                                     rows="10"
                                     rowsPerPageTemplate="10,20,30,40,50"
                                     paginatorPosition="bottom"
                                     emptyMessage="無資料"
                                     style="width: 100%">
                            <p:column style="text-align: center">
                                <f:facet name="header">
                                    <h:outputText value="IDN"/>
                                </f:facet>
                                <h:outputText value="#{item}"/>
                            </p:column>
                        </p:dataTable>
                    </p:tab>

                    <p:tab id="confirm" title="子活動資料確認">
                        <p:panel header="子活動資料確認">
                            <!--<p:commandButton value="Submit"update="growl" process="@this"/>-->
                            <p:panelGrid rendered="#{mgSetMasterController.mgSetDetail != null}" style="width: 100%">                     
                                <p:row>
                                    <p:column styleClass="ui-widget-header">
                                        <p:outputLabel value="子活動案代碼" />
                                    </p:column>
                                    <p:column>
                                        <p:outputLabel  value="#{mgSetMasterController.selected.mgActMCode}-#{mgSetMasterController.showMgSetDetailCode()}" 
                                                        title="#{bundle.CreateMgSetDetailTitle_mgActDCode}" />                          
                                    </p:column>
                                    <p:column styleClass="ui-widget-header">
                                        <p:outputLabel value="子活動案序號" />
                                    </p:column>
                                    <p:column>
                                        <p:outputLabel value="#{mgSetMasterController.showMgSetDetailCode()}" title="#{bundle.CreateMgSetDetailTitle_mgActDSeq}" />            
                                    </p:column>
                                </p:row>

                                <p:row>
                                    <p:column styleClass="ui-widget-header">
                                        <p:outputLabel value="子活動案名稱"/>
                                    </p:column>
                                    <p:column>
                                        <p:inplace>
                                            <p:inputText size="30" value="#{mgSetMasterController.mgSetDetail.mgActDName}" title="#{bundle.CreateMgSetDetailTitle_mgActDName}" 
                                                         required="true" requiredMessage="請輸入子活動案名稱"/>       
                                        </p:inplace>
                                    </p:column>
                                    <p:column styleClass="ui-widget-header">
                                        <p:outputLabel value="子活動案種類" />  
                                    </p:column>
                                    <p:column>
                                        <p:inplace>
                                            <p:selectOneRadio value="#{mgSetMasterController.mgSetDetail.mgActSetType}" required="true" requiredMessage="請選擇子活動案種類">                                           
                                                <f:selectItem itemLabel="固定費用" itemValue="F" /> 
                                                <f:selectItem itemLabel="費率" itemValue="R" /> 
                                            </p:selectOneRadio>
                                        </p:inplace>
                                    </p:column>
                                </p:row>

                                <p:row>
                                    <p:column styleClass="ui-widget-header">
                                        <p:outputLabel value="產品代號"  />  
                                    </p:column>
                                    <p:column>
                                        <p:inplace>
                                            <p:inputText  value="#{mgSetMasterController.mgSetDetail.mgActDPrdCode}" title="#{bundle.CreateMgSetDetailTitle_mgActDPrdCode}" 
                                                          required="true" requiredMessage="請輸入產品代號"/>
                                        </p:inplace>
                                    </p:column>
                                    <p:column styleClass="ui-widget-header">
                                        <p:outputLabel value="SECURITY類型"  />  
                                    </p:column>
                                    <p:column>
                                        <p:inplace>
                                            <p:selectOneRadio value="#{mgSetMasterController.mgSetDetail.mgActDSecType}" required="true" requiredMessage="請選擇SECURITY類型">
                                                <f:selectItem itemLabel="Stock" itemValue="1" />
                                                <f:selectItem itemLabel="Bond" itemValue="2" />
                                                <f:selectItem itemLabel="Fund" itemValue="3" />
                                            </p:selectOneRadio>
                                        </p:inplace>
                                    </p:column>
                                </p:row>

                                <p:row>
                                    <p:column styleClass="ui-widget-header">
                                        <p:outputLabel value="Security Company" />
                                    </p:column>
                                    <p:column>
                                        <p:inplace>
                                            <p:inputText value="#{mgSetMasterController.mgSetDetail.mgActDSecCmp}" title="#{bundle.CreateMgSetDetailTitle_mgActDSecCmp}" 
                                                         required="true" requiredMessage="請輸入Security Company"/>
                                        </p:inplace>
                                    </p:column>
                                    <p:column styleClass="ui-widget-header">
                                        <p:outputLabel value="Security Code" />
                                    </p:column>
                                    <p:column>
                                        <p:inplace>
                                            <p:inputText  value="#{mgSetMasterController.mgSetDetail.mgActDSecCode}" title="#{bundle.CreateMgSetDetailTitle_mgActDSecCode}" 
                                                          required="true" requiredMessage="請輸入Security Code"/>
                                        </p:inplace>
                                    </p:column>
                                </p:row>

                                <p:row>
                                    <p:column styleClass="ui-widget-header">
                                        <p:outputLabel value="客戶代碼"  />
                                    </p:column>
                                    <p:column>
                                        <p:inplace>
                                            <p:inputText value="#{mgSetMasterController.mgSetDetail.mgActDCostId}" title="#{bundle.CreateMgSetDetailTitle_mgActDCostId}" 
                                                         required="true" requiredMessage="請輸入客戶代碼"/>
                                        </p:inplace>
                                    </p:column>
                                    <p:column styleClass="ui-widget-header">
                                        <p:outputLabel value="業務通路代碼" />
                                    </p:column>
                                    <p:column>   
                                        <p:inplace>
                                            <p:selectOneRadio value="#{mgSetMasterController.mgSetDetail.mgActDSaleChnl}" required="true" requiredMessage="請選擇業務通路代碼">
                                                <f:selectItem itemLabel="櫃檯" itemValue="1" />
                                                <f:selectItem itemLabel="網路" itemValue="2" />
                                                <f:selectItem itemLabel="語音" itemValue="3" />
                                                <f:selectItem itemLabel="KOKO" itemValue="4" />
                                            </p:selectOneRadio>
                                        </p:inplace>
                                    </p:column>
                                </p:row>

                                <p:row>
                                    <p:column styleClass="ui-widget-header">
                                        <p:outputLabel value="子活動案開始日期"  />
                                    </p:column>
                                    <p:column>
                                        <p:inplace>
                                            <p:calendar pattern="yyyyMMdd" value="#{mgSetMasterController.start_date}" title="#{bundle.CreateMgSetDetailTitle_mgActDStartDate}"
                                                        required="true" requiredMessage="請選擇子活動案開始日期">
                                                <f:convertDateTime type="date"  dateStyle="short" pattern="yyyyMMdd" />
                                            </p:calendar>
                                        </p:inplace>
                                    </p:column>
                                    <p:column styleClass="ui-widget-header">
                                        <p:outputLabel value="子活動案結束日期" for="mgActDEndDate" />
                                    </p:column>
                                    <p:column>
                                        <p:inplace>
                                            <p:calendar pattern="yyyyMMdd" value="#{mgSetMasterController.end_date}" title="#{bundle.CreateMgSetDetailTitle_mgActDEndDate}"
                                                        required="true" requiredMessage="請選擇子活動案結束日期">
                                                <f:convertDateTime type="date"  dateStyle="short" pattern="yyyyMMdd" />
                                            </p:calendar>
                                        </p:inplace>
                                    </p:column>
                                </p:row>

                                <p:row>
                                    <p:column styleClass="ui-widget-header">
                                        <p:outputLabel value="級距設定序號???" />
                                    </p:column>
                                    <p:column>
                                        <p:inplace>
                                            <p:inputNumber value="#{mgSetMasterController.mgSetDetail.mgActDSetNo}" title="#{bundle.CreateMgSetDetailTitle_mgActDSetNo}" />
                                        </p:inplace>
                                    </p:column>
                                    <p:column styleClass="ui-widget-header">
                                        <p:outputLabel value="Base amount" />
                                    </p:column>
                                    <p:column>
                                        <p:inplace>
                                            <p:inputNumber thousandSeparator="."  decimalSeparator="," value="#{mgSetMasterController.mgSetDetail.mgActDBaseAmt}" title="#{bundle.CreateMgSetDetailTitle_mgActDBaseAmt}" />
                                        </p:inplace>
                                    </p:column>
                                </p:row>

                                <p:row>
                                    <p:column styleClass="ui-widget-header">
                                        <p:outputLabel value="最低金額"  />
                                    </p:column>
                                    <p:column>
                                        <p:inplace>
                                            <p:inputNumber  value="#{mgSetMasterController.mgSetDetail.mgActDLowAmt}" title="#{bundle.CreateMgSetDetailTitle_mgActDLowAmt}" />
                                        </p:inplace>
                                    </p:column>
                                    <p:column styleClass="ui-widget-header">
                                        <p:outputLabel value="最高金額" />
                                    </p:column>
                                    <p:column>
                                        <p:inplace>
                                            <p:inputNumber  value="#{mgSetMasterController.mgSetDetail.mgActDHighAmt}" title="#{bundle.CreateMgSetDetailTitle_mgActDHighAmt}" />
                                        </p:inplace>
                                    </p:column>
                                </p:row>   

                                <p:row>
                                    <p:column styleClass="ui-widget-header">
                                        <p:outputLabel value="一年管理費率"/>
                                    </p:column>
                                    <p:column>
                                        <p:inplace>
                                            <p:inputNumber value="#{mgSetMasterController.mgSetDetail.mgActDRate}" title="#{bundle.CreateMgSetDetailTitle_mgActDRate}" />
                                        </p:inplace>
                                    </p:column>
                                    <p:column styleClass="ui-widget-header">
                                        <p:outputLabel value="管理費金額??" />
                                    </p:column>
                                    <p:column>
                                        <p:inplace>
                                            <p:inputNumber  value="#{mgSetMasterController.mgSetDetail.mgActDFee}" title="#{bundle.CreateMgSetDetailTitle_mgActDFee}" />
                                        </p:inplace>
                                    </p:column>
                                </p:row> 

                                <p:row>
                                    <p:column styleClass="ui-widget-header">
                                        <p:outputLabel value="備註" />
                                    </p:column>
                                    <p:column colspan="3">
                                        <p:inplace>
                                            <p:inputTextarea cols="100" rows="8" value="#{mgSetMasterController.mgSetDetail.mgActDRemark}" title="#{bundle.CreateMgSetDetailTitle_mgActDRemark}" />
                                        </p:inplace>
                                    </p:column>
                                </p:row> 
                                <p:row>
                                    <p:column styleClass="ui-widget-header">
                                        <h:outputLabel for="company" value="基金公司" />　
                                    </p:column>
                                    <p:column>
                                        <p:inplace>
                                            <p:selectCheckboxMenu value="#{mgSetMasterController.selectedInvCorp}" label="Company" multiple="true"
                                                                  filter="true" filterMatchMode="endsWith" panelStyle="width:250px">
                                                <f:selectItems value="#{mgSetMasterController.invCorp}" var="invcorp" itemLabel="#{invcorp.corpCName}" itemValue="#{invcorp.corpID}" />
                                                <p:ajax listener="#{mgSetMasterController.updateFundList()}" event="change" update=":MgSetDetailCreateForm:code1" />
                                            </p:selectCheckboxMenu>
                                        </p:inplace>
                                    </p:column>
                                    <p:column styleClass="ui-widget-header">
                                        <h:outputLabel for="code" value="基金代碼" />
                                    </p:column>
                                    <p:column>
                                        <p:inplace>
                                            <p:selectCheckboxMenu id="code1" value="#{mgSetMasterController.selectedFundId}" label="Code" multiple="true"
                                                                  filter="true" filterMatchMode="startsWith" panelStyle="width:250px">
                                                <f:selectItems value="#{mgSetMasterController.fundId}" var="fund" itemLabel="#{fund.fundCShortNM}" itemValue="#{fund.fundID}" />
                                            </p:selectCheckboxMenu>
                                        </p:inplace>
                                    </p:column>
                                </p:row>
                            </p:panelGrid>
                            <p:dataTable value="#{mgSetMasterController.idnList}" var="item"                             
                                         paginator="true"                            
                                         rows="10"
                                         rowsPerPageTemplate="10,20,30,40,50"
                                         paginatorPosition="bottom"
                                         emptyMessage="無資料"
                                         style="width: 100%">
                                <p:column style="text-align: center">
                                    <f:facet name="header">
                                        <h:outputText value="IDN"/>
                                    </f:facet>
                                    <h:outputText value="#{item}"/>
                                </p:column>
                            </p:dataTable>
                        </p:panel>
                        <p:commandButton value="確認儲存" actionListener="#{mgSetMasterController.createDetail()}" update=":MgSetDetailCreateForm :MgSetMasterListForm:msgs :MgSetMasterListForm:datalist" 
                                         onclick="MgSetDetailCreateDlg.hide()" process="@this"/>
                    </p:tab>
                </p:wizard>

            </h:form>
        </p:dialog>


        <p:dialog id="MgSetDetailListDlg" widgetVar="MgSetDetailListDlg" modal="true" resizable="false" appendTo="@(body)" header="#{bundle.CreateMgSetDetailTitle}">

            <h:form id="MgSetDetailListForm">
                   <!--<p:panel header="#{bundle.ListMgSetDetailTitle}">-->
                <p:dataTable id="detailDatalist" value="#{mgSetMasterController.detailItems}" var="item"                             
                             paginator="true"                            
                             rows="10"
                             rowsPerPageTemplate="10,20,30,40,50"
                             >

                    <!--                        <p:ajax event="rowSelect"   update="createButton viewButton editButton deleteButton"/>
                                            <p:ajax event="rowUnselect" update="createButton viewButton editButton deleteButton"/>-->

                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDCode}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDCode}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDSeq}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDSeq}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActSetType}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActSetType}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDName}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDName}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDPrdCode}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDPrdCode}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDSecType}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDSecType}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDSecCmp}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDSecCmp}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDSecCode}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDSecCode}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDCostId}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDCostId}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDSaleChnl}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDSaleChnl}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDStartDate}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDStartDate}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDEndDate}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDEndDate}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDSetNo}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDSetNo}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDBaseAmt}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDBaseAmt}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDLowAmt}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDLowAmt}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDHighAmt}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDHighAmt}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDRate}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDRate}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDFee}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDFee}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDRemark}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDRemark}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgSetMasterId}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgSetMasterId}"/>
                    </p:column>
                    <!--                        <f:facet name="footer">                           
                                                <p:commandButton id="viewButton"   icon="ui-icon-search" value="#{bundle.View}" update=":MgSetDetailViewForm" oncomplete="PF('MgSetDetailViewDialog').show()" disabled="#{empty mgSetDetailController.selected}"/>
                                                <p:commandButton id="editButton"   icon="ui-icon-pencil" value="#{bundle.Edit}" update=":MgSetDetailEditForm" oncomplete="PF('MgSetDetailEditDialog').show()" disabled="#{empty mgSetDetailController.selected}"/>
                                                <p:commandButton id="deleteButton" icon="ui-icon-trash"  value="#{bundle.Delete}" actionListener="#{mgSetDetailController.destroy}" update=":growl,datalist" disabled="#{empty mgSetDetailController.selected}"/>
                                            </f:facet>-->
                </p:dataTable>

                <!--</p:panel>-->
            </h:form>
        </p:dialog>

        <p:dialog id="MgSetDetailImportDlg" width="80%" widgetVar="MgSetDetailImportDlg" modal="true" resizable="false" appendTo="@(body)" header="#{bundle.CreateMgSetDetailTitle}">
            <h:form id="MgSetDetailImportForm">
                <!--<h:panelGroup id="displayImport">-->
                <p:fileUpload 
                    label="匯入檔案"                        
                    uploadLabel="上傳" 
                    fileUploadListener="#{mgSetMasterController.handleFileUpload}"
                    multiple="true"  
                    sizeLimit="40960"
                    invalidSizeMessage="一個檔案大小最多為5Mbytes" 
                    invalidFileMessage="上傳檔案格式僅接受CSV檔"                                       
                    update=":MgSetDetailImportForm:detailDatalist"
                    />   

                <p:dataTable id="detailDatalist" value="#{mgSetMasterController.detailItems}" var="item"                              
                             paginator="true"                            
                             rows="10"
                             rowsPerPageTemplate="10,20,30,40,50"
                             >

                    <!--                        <p:ajax event="rowSelect"   update="createButton viewButton editButton deleteButton"/>
                                            <p:ajax event="rowUnselect" update="createButton viewButton editButton deleteButton"/>-->

                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDCode}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDCode}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDSeq}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDSeq}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActSetType}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActSetType}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDName}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDName}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDPrdCode}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDPrdCode}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDSecType}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDSecType}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDSecCmp}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDSecCmp}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDSecCode}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDSecCode}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDCostId}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDCostId}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDSaleChnl}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDSaleChnl}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDStartDate}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDStartDate}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDEndDate}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDEndDate}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDSetNo}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDSetNo}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDBaseAmt}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDBaseAmt}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDLowAmt}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDLowAmt}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDHighAmt}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDHighAmt}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDRate}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDRate}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDFee}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDFee}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgActDRemark}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgActDRemark}"/>
                    </p:column>
                    <p:column>
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListMgSetDetailTitle_mgSetMasterId}"/>
                        </f:facet>
                        <h:outputText value="#{item.mgSetMasterId}"/>
                    </p:column>
                    <!--                        <f:facet name="footer">                           
                                                <p:commandButton id="viewButton"   icon="ui-icon-search" value="#{bundle.View}" update=":MgSetDetailViewForm" oncomplete="PF('MgSetDetailViewDialog').show()" disabled="#{empty mgSetDetailController.selected}"/>
                                                <p:commandButton id="editButton"   icon="ui-icon-pencil" value="#{bundle.Edit}" update=":MgSetDetailEditForm" oncomplete="PF('MgSetDetailEditDialog').show()" disabled="#{empty mgSetDetailController.selected}"/>
                                                <p:commandButton id="deleteButton" icon="ui-icon-trash"  value="#{bundle.Delete}" actionListener="#{mgSetDetailController.destroy}" update=":growl,datalist" disabled="#{empty mgSetDetailController.selected}"/>
                                            </f:facet>-->
                </p:dataTable>
                <!--</h:panelGroup>-->
            </h:form>
        </p:dialog>

    </ui:composition>
</html>
